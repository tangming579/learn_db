### 认识事务

事务是访问并更新数据库中各种数据项的一个程序执行单元，在事务的操作中，要么都做修改，要么都不做修改，这就是事务的目的。

事务的ACID：

- 原子性（automatic）
- 一致性（consistent）
- 隔离性（isolation）
- 持久性（durability）

### 事务的实现

事务隔离性由锁来实现。

redo log 称为重做日志，来保证事务的原子性和持久性

undo log 来保证事务的一致性。

redo 恢复修改的页操作，undo 回滚记录到特点的版本。redo 通常是物理日志，记录的是页的物理修改操作；undo 是逻辑日志，根据每行记录进行记录。

#### redo

重做日志用来实现事务的持久性，由两部分组成：

- 内存中的重做日志缓冲（redo log buffer），其易丢失。

- 重做日志文件（redo log file），其是持久性的

InnoDB是事务的存储引擎，其通过 Force Log at Commit 机制实现事务的持久性。即当事务提交时，必须先将该事物的所有日志写入到重做日志文件进行持久化，待事务提交完成才算操作完成

#### undo

undo存放在数据库内部的一个特殊段（segment）中，这个段称为 undo段（undo segment）。undo 段位于共享表空间中。

undo 日志并非将数据库物理地恢复到执行语句或事务之前的样子。undo 是逻辑日志，只是将数据库逻辑地恢复到原来的样子，所有修改都被逻辑的取消了