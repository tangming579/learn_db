### 索引概述

InnoDB支持以下索引：B+ 树索引、Hash索引、全文索引

B+ 树索引并不能找到一个给定键值的具体行，只是被查找数据行所在的页。然后数据库通过把页读取到内存中，再在内存中查找。

### 数据结构与算法

#### 二分查找法

二分查找法（binary serach）也称为折半查找法，基本思想是：将记录按有序化（递增或递减）排列，在查找过程中采用跳跃式方法查找，即先以有序数列的中点位置为比较对象，如果查找的元素小于该中点元素，则将带查找序列缩短为左半部分，否则为右半部分。

#### 二叉查找树和平衡二叉树

二叉查找树：

```mermaid
graph TB
   6 --> 3
   6 --> 7
   3 --> 2
   3 --> 5
   7 --> 8
```

在二叉查找树中，左子树的键值总是小于根的键值，右子树的键值总是大于根的键值。因此可以通过中序遍历得到键值的排序输出。二叉查找树比顺序查找来得更快。

但如果同样的序列，一下二叉查找树效率很低，从而引出了平衡二叉树，也称 AVL 树。

```mermaid
graph TB
   2 --> 3   
   3 --> 5
   5 --> 7
   7 --> 6
   7 --> 8
```

平衡二叉树：首先满足二叉查找树定义，其次必须满足任何节点的两个子树的高度最大差为1。

平衡二叉树的查找速度快，但维护一颗平衡二叉树的代价非常大，通常需要一次或多次左旋或右旋操作来得到插入或更新后数的平衡性。

#### B+ 树

B+ 树是一种树数据结构，是一个n叉树，每个节点通常有多个孩子，一颗B+树包含根节点、内部节点和叶子节点。所有记录节点都是按键值的大小顺序存放在同一层的叶子节点上，由各叶子节点指针进行连接。B+ 树通常用于数据库和操作系统的文件系统中。 B+ 树的特点是能够保持数据稳定有序，其插入与修改拥有较稳定的对数时间复杂度。 B+ 树元素自底向上插入。

<div>
    <image src="img/5.bmp"></image>
</div>

#### B+ 树索引

数据库中的B+ 树索引分为聚集索引和辅助索引，区别是叶子节点是否存放一整行信息。

##### 聚集索引

按照每张表的主键构造一颗B+ 树，同时叶子节点中存放的即为整张表的行数据，同B+ 树数据结构一样，每个数据页都通过双向链表进行链接。

每张表只能有一个聚集索引，此外，由于定义了数据的逻辑顺序，聚集索引能够特别快速的针对范围值的查询。

#### 辅助索引

叶子节点并不包含行记录的全部数据，叶子节点除了包含键值以外，每个叶子节点的索引行中还包含了一个书签。该书签用来告诉InnoDB存储引擎哪里可以找到与索引相对应的行数据。

由于InnoDB存储引擎是**索引组织表**，因此其辅助索引的书签就是相应行数据的聚集索引键。

> 索引组织表(index organized table, IOT) 就是存储在一个索引结构中的表。索引组织表的数据按主键排序手段被存储在B-树索引中，除了存储主键列值外还存储非键列的值。普通索引只存储索引列，而索引组织表则存储表的所有列的值。